<!doctype html>
<html>

<head>
    <meta charset=utf-8>
    <link rel="icon shortcut" href=img/logo.png type=image/png>
    <link rel=apple-touch-icon href=img/logo.png>
    <link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css>
    <link rel=stylesheet href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link rel=stylesheet href=css/base.css>
    <link rel=stylesheet href=css/contract.css>
    <link rel=stylesheet href=css/ui-block.css>
    <link rel=stylesheet href=codeMirror/codemirror.css>
    <link rel=stylesheet href=codeMirror/dracula.css>
    <meta name=viewport content="width=device-width">
    <title>Blockchain playground</title>
    <style>
        .wrapperExample1 .search_contract {
            background-color: #f5f5f5;
            border: none;
        }

        .wrapperExample1 .run_contract {
            background-color: #f5f5f5;
            border: none;
            margin-top: 20px;
        }

        .run_contract span {
            color: gray;
        }

        .title {
            text-align: center;
            color: black;
            font-size: 30px;
        }

        .code {
            height: 300px;
        }

        .active1 {
            display: none;
        }
    </style>
</head>

<body>
    <div class=logo-main></div>
    <div class=header></div>


    <!-- Code Editor window -->

    <div class=wrapperExample1>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" href="#search_contract" data-toggle="tab" role="tab" aria-controls="search_contract" aria-selected="true">Search</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#run_contract" data-toggle="tab" role="tab" aria-controls="search_contract" aria-selected="true">Submit</a>
            </li>

        </ul>
        <div class="tab-content">
            <!-------- search contract ---------->
            <div class="search_contract" id="search_contract" class="tab-pane fade show active" role="tabpanel" aria-labelledby="home-tab">
                <div class="title">
                    <span>Search contract</span>
                </div>
                <input id="addr_input" type="text" placeholder="Please enter your TXhash">
                <span class="errmsg active1">Please enter a valid TX hash</span>
                <button class="search">search</button>
                <textarea class="search_result active1" name="search_result" id="search_result" cols="30" rows="10"></textarea>
            </div>

            <!-------- run contract   and deploy contract ---------->
            <div class="run_contract " id="run_contract" class="tab-pane" role="tabpanel" aria-labelledby="profile-tab">
                <div class="title">
                    <span>Submit Contract</span>
                </div>
                <span>parameter</span>
                <input type="text" id="code">
                <div class=select-wallet-file></div>

                <span>From</span>
                <input type="text" id="gas">

                <span>To</span>
                <input type="text" id="gas">

                <span>Value</span>
                <input type="text" id="gas">

                <span>Gas Limit</span>
                <input type="text" id="gas">

                <span>Gas Price : </span>
                <span id="gas_price"></span>

                <span class="errmsg_code active1">Please enter a valid code</span>


                <div class="result active1" id="result">Results:success,you can deploy this contract.</div>
                <!-- <button onclick="submit()">RUN</button> -->
                <button id="run" onclick="apiCall()">Submit</button>
                <div class="next  active1">
                    <div class="select-wallet-file"></div>
                    <button onclick="generateTransaction()">Deploy Contract</button>
                </div>
            </div>
        </div>


    </div>

    <div class=footer></div>

    <script src=codeMirror/codemirror.js></script>
    <script src=codeMirror/javascript.js></script>
    <script src=https://code.jquery.com/jquery-3.3.1.min.js></script>
    <script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js data-depends=jquery.slim></script>
    <script src=js/api.js data-depends=jquery></script>
    <script src=js/wallet.js></script>
    <script src=js/nebApi.js></script>
    <script src=js/codeEditor.js></script>
    <script src=js/i18n.js data-depends=jquery.slim></script>
    <script src=js/ui-block.js data-depends="bootbox jquery wallet.js"></script>
    <script>
        "use strict";

        uiBlock({
            footer: ".footer",
            header: ".header",
            logoMain: ".logo-main",
            selectWalletFile: [".select-wallet-file", onUnlockFile]
        });

        $(function () {
            $('#myTab li:last-child a').tab('show')
        })


        function onUnlockFile(fileJson, account, password) {
            var state, balance_nas;

            try {
                account.fromKey(fileJson, password);
                $("#fromaddress").val(account.getAddressString());
                $("#unlock").hide();
                $("#send").show();

                state = neb.api.getAccountState(account.getAddressString());
                balance_nas = Utils.toBigNumber(state.balance).dividedBy(unitValue("nas")).toNumber();

                $("#balance").val(balance_nas);
                $("#nonce").val(parseInt(state.nonce) + 1);
            } catch (e) {
                bootbox.dialog({
                    message: e,
                    size: "large",
                    title: "Error"
                });
            }
        }
        $(function () {

            $(".search").click(function () {

                if ($("#addr_input").val().length < 48) {

                    $(".errmsg").removeClass("active1");

                    setTimeout(function () {
                        $(".errmsg").addClass("active1");
                    }, 2000);

                } else {

                    api.getTx($("#addr_input").val())
                        .then(done, fail);

                    $(".search_result").removeClass("active1");

                }

            });

            function done(o) {
                console.log(o);

                $(".search_result").append(o.datd);

            }

            function fail() {
            }

            api.getGasPrice().then(done, fail);

            function done(x) {
                $("#gas_price").append(x.gas_price);
            }

            function fail() {
            }


            $("#run").click(function () {

                if ($("#code").val().length < 10) {

                    $(".errmsg_code").removeClass("active1");

                } else {

                    $(".result").removeClass("active1");

                    $(".next").removeClass("active1");

                }
            });

        })

    </script>
</body>

</html>